schema: '2.0'
stages:
  download_dataset:
    cmd: ( wget https://storage.googleapis.com/mledu-datasets/cats_and_dogs_filtered.zip
      -O cats_and_dogs_filtered.zip && unzip cats_and_dogs_filtered.zip -d ./data/raw
      && rm cats_and_dogs_filtered.zip ) &> logs/download_dataset.out
    outs:
    - path: ./data/raw
      md5: 174fe7fcb400140a007ac05c36b5bfd4.dir
      size: 68556316
      nfiles: 3001
    - path: logs/download_dataset.out
      md5: f211c659367eb1b32f30b385df5260de
      size: 325690
  split_dataset:
    cmd: python scripts/split_dataset.py &> logs/split_dataset.out
    deps:
    - path: ./data/raw
      md5: 174fe7fcb400140a007ac05c36b5bfd4.dir
      size: 68556316
      nfiles: 3001
    - path: scripts/split_dataset.py
      md5: e99a47b198dee35710b7c745b60e928c
      size: 1277
    params:
      params.yaml:
        data.dataset.val_test_split:
          val: 0.7
          test: 0.3
    outs:
    - path: ./data/dataset/dataset.csv
      md5: 2f6641598b7fc6c8d1dd031a6d595161
      size: 68108
    - path: ./data/dataset/test
      md5: 326353ae0eed20bee508f30419a0ec25.dir
      size: 6815914
      nfiles: 305
    - path: ./data/dataset/train
      md5: 0a1a83aa537b94b2b07eb1503701eca7.dir
      size: 45613376
      nfiles: 2000
    - path: ./data/dataset/val
      md5: d34d9a2762c720f7415020cd9ddabb1e.dir
      size: 16126886
      nfiles: 695
    - path: logs/split_dataset.out
      md5: 6fa4014992ad6a7d326be58d4a2563b4
      size: 2224
  train:
    cmd: python scripts/train.py &> logs/train.out
    deps:
    - path: ./data/dataset/train
      md5: 0a1a83aa537b94b2b07eb1503701eca7.dir
      size: 45613376
      nfiles: 2000
    - path: ./data/dataset/val
      md5: d34d9a2762c720f7415020cd9ddabb1e.dir
      size: 16126886
      nfiles: 695
    - path: scripts/train.py
      md5: db2b9a58cb8f07e588548c37525737e0
      size: 2581
    params:
      params.yaml:
        train:
          batch_size: 32
          img_size:
          - 160
          - 160
          learning_rate: 0.0001
          subdir: train
    outs:
    - path: ./data/train/model
      md5: 87cdfeccb6b6400ecf86225badcc33f3.dir
      size: 20669958
      nfiles: 3
    - path: logs/train.out
      md5: d70b8a1149430a1f73b4b65ffd25ff8f
      size: 205985
